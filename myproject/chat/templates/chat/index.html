{% extends "base.html" %}
{% load static %}

{% block title %}AI Agent Platform | Social Media Management{% endblock %}

{% block extra_css %}
<style>
    body {
        height: 100vh;
        display: flex;
        flex-direction: column;
    }
    
    .container.mt-4 {
        flex: 1;
        display: flex;
        flex-direction: column;
    }
    
    .chat-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        min-height: 0;
    }
</style>
{% endblock %}

{% block content %}
<div class="chat-container">
    <!-- Agent Info -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="d-flex align-items-center">
            <span class="agent-icon fs-4 me-2">ðŸ§ </span>
            <h2 class="mb-0">Social Media AI Assistant</h2>
        </div>
    </div>
    
    <div class="alert alert-info mb-3" role="alert">
        <i class="fas fa-info-circle me-2"></i>
        <strong>AI Agent Platform</strong>: Your intelligent assistant that coordinates specialized tools to help with all your social media management needs.
    </div>

    <!-- Chat Messages -->
    <div id="chat-content" class="chat-messages flex-grow-1 mb-3 border rounded p-3 overflow-auto">
        {% if messages %}
            {% for message in messages %}
                <div class="message {% if message.is_user %}user-message{% else %}ai-message{% endif %}">
                    <div class="message-content">{{ message.content }}</div>
                    <span class="message-time">
                        {% if message.is_user %}You{% else %}AI{% endif %} â€¢ {{ message.timestamp|date:"M d, g:i a" }}
                    </span>
                </div>
            {% endfor %}
        {% else %}
            <div class="message ai-message">
                <div class="message-content">
                    Hi there! I'm your AI assistant for social media management. I can help with creating ad campaigns, analyzing performance data, generating content, and more. How can I help you today?
                </div>
                <span class="message-time">AI â€¢ Just now</span>
            </div>
        {% endif %}
    </div>

    <!-- Sending Indicator -->
    <div id="sending-indicator" class="d-none align-items-center mb-2">
        <div class="spinner-border spinner-border-sm text-primary me-2" role="status"></div>
        <span>AI is thinking...</span>
    </div>

    <!-- Message Form -->
    <form id="message-form" class="message-form">
        {% csrf_token %}
        <div class="input-group">
            <textarea 
                id="message-input" 
                class="form-control" 
                placeholder="Type your message here..." 
                rows="2"
                required
            ></textarea>
            <button type="submit" class="btn btn-primary">
                <i class="fas fa-paper-plane me-1"></i>Send
            </button>
        </div>
        <div class="form-text mt-1">Press Enter to send, Shift+Enter for a new line</div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Set agent ID in meta tag for JavaScript usage
    document.head.appendChild(
        Object.assign(document.createElement('meta'), {
            name: 'agent-id',
            content: 'primary'
        })
    );
    
    // Convert the sending indicator to flex display
    const sendingIndicator = document.getElementById('sending-indicator');
    sendingIndicator.classList.remove('d-none');
    sendingIndicator.style.display = 'none';
</script>
{% endblock %} 